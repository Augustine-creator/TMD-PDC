<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TMD PDC Project - Ultimate Interactive Presentation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        :root {
            --tmd-yellow: #FFD700;
            --tmd-blue: #1E90FF;
            --tmd-white: #FFFFFF;
            --tmd-black: #2C3E50;
            --tmd-red: #E74C3C;
            --isuzu-red: #DC143C;
            --gradient-primary: linear-gradient(135deg, var(--tmd-blue) 0%, var(--tmd-yellow) 100%);
            --gradient-secondary: linear-gradient(45deg, var(--tmd-yellow) 0%, var(--tmd-blue) 50%, var(--tmd-black) 100%);
            --gradient-isuzu: linear-gradient(135deg, var(--isuzu-red) 0%, #B22222 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--gradient-primary);
            min-height: 100vh;
            color: var(--tmd-black);
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        .theme-yellow { background: linear-gradient(135deg, var(--tmd-yellow) 0%, #FFA500 100%); }
        .theme-blue { background: linear-gradient(135deg, var(--tmd-blue) 0%, #0066CC 100%); }
        .theme-dark { background: linear-gradient(135deg, var(--tmd-black) 0%, #34495e 100%); color: var(--tmd-white); }

        /* Mobile-First Responsive Design */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-bottom: 4px solid var(--tmd-yellow);
            box-shadow: 0 8px 32px rgba(0,0,0,0.15);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .isuzu-logo {
            width: 80px;
            height: 50px;
            background: var(--isuzu-red);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
            border-radius: 8px;
            border: 2px solid var(--tmd-black);
            transition: all 0.3s ease;
        }

        .isuzu-logo:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 20px rgba(220, 20, 60, 0.4);
        }

        .tmd-logo {
            width: 80px;
            height: 50px;
            background: linear-gradient(135deg, var(--tmd-yellow) 0%, var(--tmd-blue) 100%);
            border: 3px solid var(--tmd-red);
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: all 0.3s ease;
        }

        .tmd-logo:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 8px 25px rgba(30, 144, 255, 0.4);
        }

        .tmd-logo::before {
            content: 'TMD';
            color: var(--tmd-white);
            font-weight: bold;
            font-size: 18px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .tmd-logo::after {
            content: 'KENYA';
            color: var(--tmd-black);
            font-weight: bold;
            font-size: 10px;
            position: absolute;
            bottom: 3px;
        }

        .controls {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            background: var(--gradient-primary);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            font-size: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: all 0.5s ease;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .btn:hover::before {
            left: 100%;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 10px;
        }

        /* Ultra-Vibrant Hero Section */
        .hero-section {
            text-align: center;
            padding: 30px 20px;
            background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(248,249,250,0.95) 100%);
            border-radius: 25px;
            margin: 20px 10px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-conic-gradient(
                from 0deg at 50% 50%,
                transparent 0deg,
                rgba(30, 144, 255, 0.05) 45deg,
                transparent 90deg,
                rgba(255, 215, 0, 0.05) 135deg,
                transparent 180deg
            );
            animation: ultraRotate 20s linear infinite;
        }

        @keyframes ultraRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .hero-title {
            font-size: clamp(2rem, 8vw, 4rem);
            font-weight: 900;
            background: var(--gradient-secondary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            animation: titlePulse 3s ease-in-out infinite;
        }

        @keyframes titlePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .hero-subtitle {
            font-size: clamp(1rem, 3vw, 1.5rem);
            color: var(--tmd-black);
            margin-bottom: 30px;
            opacity: 0.9;
        }

        /* Super Vibrant 3D Containers */
        .container-showcase {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin: 30px 0;
            padding: 0 10px;
        }

        .container-3d {
            width: 100%;
            height: 180px;
            perspective: 1500px;
            cursor: grab;
        }

        .container-3d:active { cursor: grabbing; }

        .container-box {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s ease;
            animation: megaFloat 8s ease-in-out infinite;
        }

        .container-box:hover {
            animation-play-state: paused;
            transform: rotateY(360deg) rotateX(25deg) scale(1.1);
        }

        @keyframes megaFloat {
            0%, 100% { transform: rotateY(0deg) rotateX(0deg) translateY(0px) translateZ(0px); }
            25% { transform: rotateY(90deg) rotateX(15deg) translateY(-15px) translateZ(10px); }
            50% { transform: rotateY(180deg) rotateX(0deg) translateY(0px) translateZ(20px); }
            75% { transform: rotateY(270deg) rotateX(-15deg) translateY(-10px) translateZ(10px); }
        }

        .container-face {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 4px solid var(--tmd-yellow);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            font-size: clamp(1rem, 2.5vw, 1.3rem);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
            border-radius: 15px;
        }

        /* PDC Container Faces */
        .pdc-container .front { 
            background: linear-gradient(45deg, var(--tmd-blue), var(--tmd-yellow), var(--isuzu-red)); 
            transform: rotateY(0deg) translateZ(90px); 
        }
        .pdc-container .back { 
            background: linear-gradient(45deg, var(--tmd-yellow), var(--tmd-blue), var(--tmd-black)); 
            transform: rotateY(180deg) translateZ(90px); 
        }
        .pdc-container .right { 
            background: linear-gradient(45deg, var(--tmd-black), var(--tmd-blue), var(--tmd-yellow)); 
            transform: rotateY(90deg) translateZ(140px); 
        }
        .pdc-container .left { 
            background: linear-gradient(45deg, var(--tmd-blue), var(--tmd-black), var(--isuzu-red)); 
            transform: rotateY(-90deg) translateZ(140px); 
        }
        .pdc-container .top { 
            background: linear-gradient(45deg, var(--tmd-yellow), var(--isuzu-red), var(--tmd-blue)); 
            transform: rotateX(90deg) translateZ(90px); 
        }
        .pdc-container .bottom { 
            background: linear-gradient(45deg, var(--isuzu-red), var(--tmd-yellow), var(--tmd-black)); 
            transform: rotateX(-90deg) translateZ(90px); 
        }

        /* Satellite Container Faces */
        .satellite-container .front { 
            background: linear-gradient(45deg, var(--tmd-yellow), #FFA500, var(--tmd-blue)); 
            transform: rotateY(0deg) translateZ(90px); 
        }
        .satellite-container .back { 
            background: linear-gradient(45deg, #FFA500, var(--tmd-yellow), var(--tmd-black)); 
            transform: rotateY(180deg) translateZ(90px); 
        }
        .satellite-container .right { 
            background: linear-gradient(45deg, var(--tmd-blue), var(--tmd-yellow), #FFA500); 
            transform: rotateY(90deg) translateZ(140px); 
        }
        .satellite-container .left { 
            background: linear-gradient(45deg, var(--tmd-yellow), var(--tmd-blue), var(--tmd-black)); 
            transform: rotateY(-90deg) translateZ(140px); 
        }
        .satellite-container .top { 
            background: linear-gradient(45deg, var(--tmd-black), var(--tmd-yellow), var(--tmd-blue)); 
            transform: rotateX(90deg) translateZ(90px); 
        }
        .satellite-container .bottom { 
            background: linear-gradient(45deg, var(--tmd-yellow), var(--tmd-black), #FFA500); 
            transform: rotateX(-90deg) translateZ(90px); 
        }

        /* Editable Content */
        .editable {
            border: 2px dashed transparent;
            transition: all 0.3s ease;
            padding: 5px;
            border-radius: 5px;
            position: relative;
        }

        .editable:hover {
            border-color: var(--tmd-blue);
            background: rgba(30, 144, 255, 0.05);
        }

        .editable:focus {
            outline: none;
            border-color: var(--tmd-yellow);
            background: rgba(255, 215, 0, 0.1);
        }

        /* Enhanced Table Cell Styling */
        td.editable:not(.non-editable), th.editable:not(.non-editable) {
            position: relative;
        }

        td.editable:not(.non-editable):hover::after, th.editable:not(.non-editable):hover::after {
            content: '‚úèÔ∏è';
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 12px;
            color: var(--tmd-blue);
            opacity: 0.7;
        }

        td.editable:focus::after, th.editable:focus::after {
            content: 'üíæ';
            font-size: 12px;
            color: var(--tmd-yellow);
        }

        /* Enhanced Section Title Styling */
        .section h2.editable:hover::after {
            content: '‚úèÔ∏è';
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 14px;
            color: var(--tmd-blue);
            opacity: 0.7;
        }

        .section h2.editable:focus::after {
            content: 'üíæ';
            font-size: 14px;
            color: var(--tmd-yellow);
        }

        /* Sections */
        .section {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 10px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.12);
            border-left: 6px solid var(--tmd-yellow);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: var(--gradient-primary);
            opacity: 0.1;
            border-radius: 50%;
            transform: translate(50%, -50%);
        }

        .section:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.18);
            border-left-color: var(--tmd-blue);
        }

        .section h2 {
            color: var(--tmd-black);
            margin-bottom: 20px;
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .section h2::after {
            content: '';
            display: block;
            width: 80px;
            height: 4px;
            background: var(--gradient-primary);
            margin: 10px auto;
            border-radius: 2px;
        }

        /* Ultra-Creative Route Diagram */
        .route-diagram {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 25px;
            padding: 30px 20px;
            margin: 25px 0;
            border: 4px solid var(--tmd-yellow);
            position: relative;
            overflow: hidden;
        }

        .route-diagram::before {
            content: 'INTELLIGENT DISTRIBUTION NETWORK';
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 14px;
            font-weight: bold;
            color: var(--tmd-blue);
            background: white;
            padding: 8px 20px;
            border-radius: 20px;
            border: 3px solid var(--tmd-yellow);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .route-level {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            position: relative;
            flex-wrap: wrap;
            gap: 15px;
        }

        .route-box {
            background: var(--gradient-primary);
            color: white;
            padding: 15px 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: all 0.5s ease;
            cursor: pointer;
            font-weight: bold;
            text-align: center;
            min-width: 120px;
            position: relative;
            border: 3px solid var(--tmd-yellow);
            overflow: hidden;
        }

        .route-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: all 0.5s ease;
        }

        .route-box:hover {
            transform: translateY(-10px) scale(1.08) rotate(2deg);
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            background: var(--gradient-secondary);
        }

        .route-box:hover::before {
            left: 100%;
        }

        .route-box.iea {
            background: var(--gradient-isuzu);
            font-size: 1.2rem;
            padding: 20px 30px;
            border-color: var(--isuzu-red);
        }

        .route-box.pdc {
            background: linear-gradient(45deg, var(--tmd-blue), var(--tmd-yellow));
        }

        .route-box.warehouse {
            background: linear-gradient(45deg, var(--tmd-yellow), var(--tmd-blue));
        }

        .route-box.customer {
            background: linear-gradient(45deg, var(--tmd-black), var(--tmd-blue));
            font-size: 0.9rem;
        }

        .arrow {
            font-size: 2rem;
            color: var(--tmd-blue);
            animation: arrowPulse 2s infinite;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin: 0 10px;
        }

        @keyframes arrowPulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.7; }
        }

        /* Enhanced Statistics */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
            padding: 0 10px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(248,249,250,0.95) 100%);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            transition: all 0.5s ease;
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: var(--gradient-primary);
        }

        .stat-card:hover {
            transform: translateY(-8px) scale(1.03);
            border-color: var(--tmd-yellow);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .stat-number {
            font-size: clamp(2.5rem, 6vw, 4rem);
            font-weight: 900;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            animation: numberCount 2s ease-out;
        }

        @keyframes numberCount {
            from { transform: scale(0); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .stat-label {
            color: var(--tmd-black);
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 1rem;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: rgba(30, 144, 255, 0.2);
            border-radius: 5px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-primary);
            transition: width 3s ease;
            border-radius: 5px;
            position: relative;
        }

        .progress-fill::after {
            content: attr(data-percent);
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-size: 10px;
            font-weight: bold;
        }

        /* Enhanced Tables */
        .table-container {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            overflow-x: auto;
            border: 3px solid var(--tmd-yellow);
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            color: var(--tmd-black);
            font-size: 14px;
        }

        th, td {
            padding: 15px 12px;
            text-align: left;
            border-bottom: 2px solid #f8f9fa;
        }

        th {
            background: var(--gradient-primary);
            color: white;
            font-weight: bold;
            position: sticky;
            top: 0;
            font-size: 13px;
        }

        tr:hover {
            background: rgba(30, 144, 255, 0.05);
            transform: scale(1.01);
            transition: all 0.2s ease;
        }

        /* Chart Containers */
        .chart-container {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            height: 350px;
            border: 3px solid var(--tmd-yellow);
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        /* Floating Action Menu */
        .floating-action {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--gradient-primary);
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .floating-action:hover {
            transform: scale(1.2) rotate(180deg);
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }

        .fab-menu {
            position: fixed;
            bottom: 90px;
            right: 20px;
            display: none;
            flex-direction: column;
            gap: 10px;
            z-index: 999;
        }

        .fab-menu.show {
            display: flex;
        }

        .fab-item {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-secondary);
            border: none;
            color: white;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            font-size: 1.2rem;
        }

        .fab-item:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        /* Enhanced Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            backdrop-filter: blur(8px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 25px;
            max-width: 90%;
            width: 500px;
            border: 4px solid var(--tmd-yellow);
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .header {
                padding: 8px 15px;
                flex-wrap: wrap;
            }
            
            .controls {
                order: 3;
                width: 100%;
                justify-content: center;
                margin-top: 10px;
            }
            
            .btn {
                padding: 6px 12px;
                font-size: 11px;
            }
            
            .container {
                padding: 5px;
            }
            
            .section {
                margin: 15px 5px;
                padding: 20px 15px;
            }
            
            .route-level {
                flex-direction: column;
                gap: 10px;
            }
            
            .arrow {
                transform: rotate(90deg);
            }
            
            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
            }
            
            .chart-container {
                height: 250px;
                padding: 15px;
            }
            
            .floating-action {
                bottom: 15px;
                right: 15px;
                width: 50px;
                height: 50px;
            }
        }

        /* Print Styles */
        @media print {
            .floating-action, .fab-menu, .controls {
                display: none !important;
            }
            
            .section {
                break-inside: avoid;
                margin: 10px 0;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo-container">
            <div class="isuzu-logo">ISUZU</div>
        </div>
        
        <div class="controls">
            <button class="btn" onclick="changeTheme('default')">üåà Default</button>
            <button class="btn" onclick="changeTheme('yellow')">üü° Yellow</button>
            <button class="btn" onclick="changeTheme('blue')">üîµ Blue</button>
            <button class="btn" onclick="changeTheme('dark')">‚ö´ Dark</button>
            <button class="btn" id="editBtn" onclick="toggleEdit()">‚úèÔ∏è Edit</button>
            <button class="btn" onclick="exportToPDF()">üìÑ PDF</button>
            <button class="btn" onclick="savePresentation()">üíæ Save</button>
        </div>
        
        <div class="logo-container">
            <div class="tmd-logo"></div>
        </div>
    </div>

    <div class="container">
        <!-- Ultra-Dynamic Hero Section -->
        <div class="hero-section">
            <div class="hero-content">
                <h1 class="hero-title editable" contenteditable="false">TMD PDC PROJECT</h1>
                <p class="hero-subtitle editable" contenteditable="false">
                    Revolutionary Automotive Parts Distribution Network - Transforming TMD Kenya Supply Chain
                </p>
                
                

        <!-- Executive Summary with KPIs -->
        <div class="section">
            <h2 class="editable" contenteditable="false">üìã Executive Summary</h2>
            <p class="editable" contenteditable="false" style="color: var(--tmd-black); line-height: 1.8; font-size: 1.1rem; margin-bottom: 20px;">
                The TMD PDC Project revolutionizes automotive parts distribution across Kenya through a strategically positioned 
                distribution center at TMD Ruaka. This initiative addresses critical supply chain bottlenecks while creating 
                new revenue streams through optimized stockist partnerships and volume-based pricing strategies.
            </p>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number editable" contenteditable="false">20</div>
                    <div class="stat-label editable" contenteditable="false">Towns Mapped</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 85%;" data-percent="85%"></div>
                    </div>
                    <small class="editable" contenteditable="false">Target: 24 | Current: 20 | Status: On Track</small>
                </div>
                <div class="stat-card">
                    <div class="stat-number editable" contenteditable="false">6</div>
                    <div class="stat-label editable" contenteditable="false">Regional Branches</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 100%;" data-percent="100%"></div>
                    </div>
                    <small class="editable" contenteditable="false">All branches operational and integrated</small>
                </div>
                <div class="stat-card">
                    <div class="stat-number editable" contenteditable="false">10</div>
                    <div class="stat-label editable" contenteditable="false">Aftersales Agents</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 70%;" data-percent="70%"></div>
                    </div>
                    <small class="editable" contenteditable="false">7 recruited, 3 in training pipeline</small>
                </div>
                <div class="stat-card">
                    <div class="stat-number editable" contenteditable="false">200+</div>
                    <div class="stat-label editable" contenteditable="false">Target Stockists</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 44%;" data-percent="44%"></div>
                    </div>
                    <small class="editable" contenteditable="false">88 current, 112 pipeline prospects</small>
                </div>
            </div>
        </div>

        <!-- Ultra-Creative Route to Market -->
        <div class="section">
            <h2 class="editable" contenteditable="false">üöÄ Intelligent Distribution Network</h2>
            <div class="route-diagram">
                <!-- IEA Distribution Level -->
                <div class="route-level">
                    <div class="route-box iea editable" contenteditable="false">
                        üè¢ IEA DISTRIBUTION<br>
                        <small>Primary Source</small>
                    </div>
                </div>
                
                <div class="route-level">
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="arrow">‚ÜôÔ∏è</div>
                    <div class="arrow">‚ÜòÔ∏è</div>
                </div>
                
                <!-- Primary Distribution Hubs -->
                <div class="route-level">
                    <div class="route-box pdc editable" contenteditable="false">
                        üì¶ PDC WAREHOUSE<br>
                        <small>Stockist Focus Hub</small><br>
                        <strong style="color: var(--tmd-white);">35% Discount Target</strong>
                    </div>
                    <div class="route-box warehouse editable" contenteditable="false">
                        üè≠ TMD MAIN WAREHOUSE<br>
                        <small>Direct Sales Hub</small><br>
                        <strong style="color: var(--tmd-white);">25% Current Discount</strong>
                    </div>
                </div>
                
                <div class="route-level">
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div style="display: flex; gap: 20px;">
                        <div class="arrow">‚ÜôÔ∏è</div>
                        <div class="arrow">‚¨áÔ∏è</div>
                        <div class="arrow">‚ÜòÔ∏è</div>
                    </div>
                </div>
                
                <!-- Secondary Distribution -->
                <div class="route-level" style="flex-wrap: wrap; justify-content: space-around;">
                    <div class="route-box customer editable" contenteditable="false">
                        üè™ STOCKISTS<br>
                        <small>15% Discount</small><br>
                        <strong style="color: var(--tmd-white);">40-60% Markup</strong>
                    </div>
                    <div class="route-box customer editable" contenteditable="false">
                        üîß WORKSHOPS<br>
                        <small>Service Centers</small><br>
                        <strong style="color: var(--tmd-white);">Direct Sales</strong>
                    </div>
                    <div class="route-box customer editable" contenteditable="false">
                        üõí RETAIL SALES<br>
                        <small>Walk-in Customers</small><br>
                        <strong style="color: var(--tmd-white);">Counter Sales</strong>
                    </div>
                    <div class="route-box customer editable" contenteditable="false">
                        üöó BODYSHOPS<br>
                        <small>Repair Services</small><br>
                        <strong style="color: var(--tmd-white);">Bulk Orders</strong>
                    </div>
                </div>
                
                <div class="route-level">
                    <div class="arrow">‚¨áÔ∏è</div>
                </div>
                
                <!-- End Customer Level -->
                <div class="route-level" style="flex-wrap: wrap; justify-content: space-around;">
                    <div class="route-box customer editable" contenteditable="false">
                        üîß PGMs<br>
                        <small>Private Garage Mechanics</small><br>
                        <strong style="color: var(--tmd-white);">Via Stockists</strong>
                    </div>
                    <div class="route-box customer editable" contenteditable="false">
                        ‚õΩ SERVICE STATIONS<br>
                        <small>Commercial Services</small><br>
                        <strong style="color: var(--tmd-white);">Fleet Maintenance</strong>
                    </div>
                    <div class="route-box customer editable" contenteditable="false">
                        üöõ FLEET CUSTOMERS<br>
                        <small>Commercial Fleets</small><br>
                        <strong style="color: var(--tmd-white);">Volume Discounts</strong>
                    </div>
                </div>
            </div>
        </div>

        <!-- Strategic Pricing Model -->
        <div class="section">
            <h2 class="editable" contenteditable="false">üí∞ Strategic Pricing & Business Model</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th class="editable" contenteditable="false">Distribution Level</th>
                            <th class="editable" contenteditable="false">Current Discount</th>
                            <th class="editable" contenteditable="false">PDC Target Discount</th>
                            <th class="editable" contenteditable="false">Markup Potential</th>
                            <th class="editable" contenteditable="false">Volume Impact</th>
                            <th class="editable" contenteditable="false">Revenue Projection</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="editable" contenteditable="false"><strong>IEA ‚Üí TMD</strong></td>
                            <td class="editable" contenteditable="false">25%</td>
                            <td class="editable" contenteditable="false" style="background: rgba(30, 144, 255, 0.1);"><strong>35%</strong></td>
                            <td class="editable" contenteditable="false">N/A</td>
                            <td class="editable" contenteditable="false">+300%</td>
                            <td class="editable" contenteditable="false">KES 45M annually</td>
                        </tr>
                        <tr>
                            <td class="editable" contenteditable="false"><strong>PDC ‚Üí Stockists</strong></td>
                            <td class="editable" contenteditable="false">N/A</td>
                            <td class="editable" contenteditable="false" style="background: rgba(255, 215, 0, 0.1);"><strong>15%</strong></td>
                            <td class="editable" contenteditable="false">40-60%</td>
                            <td class="editable" contenteditable="false">+250%</td>
                            <td class="editable" contenteditable="false">KES 30M annually</td>
                        </tr>
                        <tr>
                            <td class="editable" contenteditable="false"><strong>Stockists ‚Üí End Users</strong></td>
                            <td class="editable" contenteditable="false">Variable</td>
                            <td class="editable" contenteditable="false">Standardized</td>
                            <td class="editable" contenteditable="false">40-60%</td>
                            <td class="editable" contenteditable="false">+150%</td>
                            <td class="editable" contenteditable="false">KES 75M annually</td>
                        </tr>
                        <tr class="non-editable" style="background: rgba(46, 204, 113, 0.1);">
                            <td class="non-editable"><strong>TOTAL IMPACT</strong></td>
                            <td class="non-editable" colspan="2"><strong>10% Additional IEA Discount</strong></td>
                            <td class="non-editable"><strong>Healthy Margins</strong></td>
                            <td class="non-editable"><strong>+200% Volume</strong></td>
                            <td class="non-editable"><strong>KES 150M+ annually</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Market Storm Analytics with Enhanced Charts -->
        <div class="section">
            <h2 class="editable" contenteditable="false">‚ö° Market Storm Performance Analytics</h2>
            <div class="chart-container">
                <canvas id="marketStormChart"></canvas>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number editable" contenteditable="false">47</div>
                    <div class="stat-label editable" contenteditable="false">Stockists Visited</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 94%;" data-percent="94%"></div>
                    </div>
                    <small class="editable" contenteditable="false">Target: 50 | Achievement: 94% | Conversion: 68%</small>
                </div>
                <div class="stat-card">
                    <div class="stat-number editable" contenteditable="false">32</div>
                    <div class="stat-label editable" contenteditable="false">PGMs Engaged</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 80%;" data-percent="80%"></div>
                    </div>
                    <small class="editable" contenteditable="false">Target: 40 | Active: 25 | Training: 7</small>
                </div>
                <div class="stat-card">
                    <div class="stat-number editable" contenteditable="false">156</div>
                    <div class="stat-label editable" contenteditable="false">Sample Kits Distributed</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 104%;" data-percent="104%"></div>
                    </div>
                    <small class="editable" contenteditable="false">Target: 150 | Distributed: 156 | Reorders: 89</small>
                </div>
                <div class="stat-card">
                    <div class="stat-number editable" contenteditable="false">KES 650K</div>
                    <div class="stat-label editable" contenteditable="false">Revenue Generated</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 130%;" data-percent="130%"></div>
                    </div>
                    <small class="editable" contenteditable="false">Target: KES 500K | Actual: KES 650K</small>
                </div>
            </div>
        </div>

        <!-- Regional Coverage Analysis -->
        <div class="section">
            <h2 class="editable" contenteditable="false">üåç Comprehensive Regional Analysis</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th class="editable" contenteditable="false">Branch Hub</th>
                            <th class="editable" contenteditable="false">Coverage Towns</th>
                            <th class="editable" contenteditable="false">Market Size (Annual)</th>
                            <th class="editable" contenteditable="false">Current Stockists</th>
                            <th class="editable" contenteditable="false">Target Growth</th>
                            <th class="editable" contenteditable="false">PDC Impact</th>
                            <th class="editable" contenteditable="false">Priority</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="editable" contenteditable="false"><strong>Ruaka Branch</strong></td>
                            <td class="editable" contenteditable="false">Ruaka, Githunguri, Kahawa West, Kiambu, Limuru, Banana, Ruiru, Juja, Kamakis, Utawala, Rironi, Naivasha, Mai Mahiu</td>
                            <td class="editable" contenteditable="false">KES 45M</td>
                            <td class="editable" contenteditable="false">25 Active</td>
                            <td class="editable" contenteditable="false">+150%</td>
                            <td class="editable" contenteditable="false">Primary Hub</td>
                            <td class="editable" contenteditable="false" style="color: var(--tmd-red); font-weight: bold;">HIGH</td>
                        </tr>
                        <tr>
                            <td class="editable" contenteditable="false"><strong>Thika Branch</strong></td>
                            <td class="editable" contenteditable="false">Thika Town, Makongeni, Kenol, Juja, Witeithie, Muranga, Kabati</td>
                            <td class="editable" contenteditable="false">KES 32M</td>
                            <td class="editable" contenteditable="false">18 Active</td>
                            <td class="editable" contenteditable="false">+120%</td>
                            <td class="editable" contenteditable="false">Satellite Hub</td>
                            <td class="editable" contenteditable="false" style="color: orange; font-weight: bold;">MEDIUM</td>
                        </tr>
                        <tr>
                            <td class="editable" contenteditable="false"><strong>Karatina Branch</strong></td>
                            <td class="editable" contenteditable="false">Sagana, Karatina Town, Kerugoya, Mwea, Embu, Runyenjes, Chaka, Narumoru, Nanyuki, Nyeri</td>
                            <td class="editable" contenteditable="false">KES 28M</td>
                            <td class="editable" contenteditable="false">15 Active</td>
                            <td class="editable" contenteditable="false">+100%</td>
                            <td class="editable" contenteditable="false">Regional Hub</td>
                            <td class="editable" contenteditable="false" style="color: orange; font-weight: bold;">MEDIUM</td>
                        </tr>
                        <tr>
                            <td class="editable" contenteditable="false"><strong>Athi River Branch</strong></td>
                            <td class="editable" contenteditable="false">Mlolongo, Athi River, Kitengela, Kajiado, Bisil</td>
                            <td class="editable" contenteditable="false">KES 22M</td>
                            <td class="editable" contenteditable="false">12 Active</td>
                            <td class="editable" contenteditable="false">+80%</td>
                            <td class="editable" contenteditable="false">Support Hub</td>
                            <td class="editable" contenteditable="false" style="color: var(--tmd-blue); font-weight: bold;">STANDARD</td>
                        </tr>
                        <tr>
                            <td class="editable" contenteditable="false"><strong>Machakos Branch</strong></td>
                            <td class="editable" contenteditable="false">Machakos Town, Kyumbi, Kimana, Loitoktok, Masii, Emali</td>
                            <td class="editable" contenteditable="false">KES 18M</td>
                            <td class="editable" contenteditable="false">10 Active</td>
                            <td class="editable" contenteditable="false">+75%</td>
                            <td class="editable" contenteditable="false">Support Hub</td>
                            <td class="editable" contenteditable="false" style="color: var(--tmd-blue); font-weight: bold;">STANDARD</td>
                        </tr>
                        <tr>
                            <td class="editable" contenteditable="false"><strong>Kitui Branch</strong></td>
                            <td class="editable" contenteditable="false">Kitui Town, Mwingi, Kanyonyo, Matuu, Garissa</td>
                            <td class="editable" contenteditable="false">KES 15M</td>
                            <td class="editable" contenteditable="false">8 Active</td>
                            <td class="editable" contenteditable="false">+60%</td>
                            <td class="editable" contenteditable="false">Support Hub</td>
                            <td class="editable" contenteditable="false" style="color: var(--tmd-blue); font-weight: bold;">STANDARD</td>
                        </tr>
                        <tr class="non-editable" style="background: rgba(255, 215, 0, 0.1); font-weight: bold;">
                            <td class="non-editable">TOTAL NETWORK</td>
                            <td class="non-editable">60+ Towns Covered</td>
                            <td class="non-editable">KES 160M</td>
                            <td class="non-editable">88 Current</td>
                            <td class="non-editable">+127%</td>
                            <td class="non-editable">Full Integration</td>
                            <td class="non-editable">STRATEGIC</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Advanced Business Recommendations -->
        <div class="section">
            <h2 class="editable" contenteditable="false">üéØ Advanced Strategic Recommendations</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                <div style="background: linear-gradient(135deg, rgba(30, 144, 255, 0.1) 0%, rgba(255, 215, 0, 0.1) 100%); padding: 25px; border-radius: 15px; border-left: 5px solid var(--tmd-blue);">
                    <h3 style="color: var(--tmd-blue); margin-bottom: 15px;" class="editable" contenteditable="false">üè¶ Bank Partnership Intelligence</h3>
                    <p class="editable" contenteditable="false"><strong>Strategy:</strong> Leverage banking relationships for warm stockist referrals</p>
                    <p class="editable" contenteditable="false"><strong>Implementation:</strong> Train bank staff with digital referral tools and commission structure</p>
                    <p class="editable" contenteditable="false"><strong>Expected ROI:</strong> 40% faster customer acquisition, 25% lower cost per lead</p>
                </div>
                
                <div style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(231, 76, 60, 0.1) 100%); padding: 25px; border-radius: 15px; border-left: 5px solid var(--tmd-yellow);">
                    <h3 style="color: var(--tmd-yellow); margin-bottom: 15px;" class="editable" contenteditable="false">‚ö° Territory-Based Storm Operations</h3>
                    <p class="editable" contenteditable="false"><strong>Strategy:</strong> Deploy specialized teams with weekly performance targets</p>
                    <p class="editable" contenteditable="false"><strong>Implementation:</strong> Standardized "Storm Packs" with samples, branded materials, and digital tracking</p>
                    <p class="editable" contenteditable="false"><strong>Expected ROI:</strong> 150% increase in market penetration, 60% improvement in brand visibility</p>
                </div>
                
                <div style="background: linear-gradient(135deg, rgba(231, 76, 60, 0.1) 0%, rgba(30, 144, 255, 0.1) 100%); padding: 25px; border-radius: 15px; border-left: 5px solid var(--tmd-red);">
                    <h3 style="color: var(--tmd-red); margin-bottom: 15px;" class="editable" contenteditable="false">üîß Mechanic Loyalty Ecosystem</h3>
                    <p class="editable" contenteditable="false"><strong>Strategy:</strong> Create comprehensive mechanic incentive and training program</p>
                    <p class="editable" contenteditable="false"><strong>Implementation:</strong> Digital loyalty cards, tiered rewards, mobile money integration</p>
                    <p class="editable" contenteditable="false"><strong>Expected ROI:</strong> 80% improvement in customer retention, 45% increase in referral rates</p>
                </div>
                
                <div style="background: linear-gradient(135deg, rgba(46, 204, 113, 0.1) 0%, rgba(30, 144, 255, 0.1) 100%); padding: 25px; border-radius: 15px; border-left: 5px solid #2ECC71;">
                    <h3 style="color: #2ECC71; margin-bottom: 15px;" class="editable" contenteditable="false">üì¶ Smart Sample Distribution</h3>
                    <p class="editable" contenteditable="false"><strong>Strategy:</strong> AI-powered sample kit customization based on customer profile</p>
                    <p class="editable" contenteditable="false"><strong>Implementation:</strong> Data-driven kit composition with follow-up automation</p>
                    <p class="editable" contenteditable="false"><strong>Expected ROI:</strong> 90% trial-to-customer conversion, 35% reduction in sample waste</p>
                </div>
            </div>
        </div>

        <!-- Performance Projections Chart -->
        <div class="section">
            <h2 class="editable" contenteditable="false">üìà Performance Projections & Growth Trajectory</h2>
            <div class="chart-container">
                <canvas id="projectionChart"></canvas>
            </div>
        </div>

        <!-- Interactive Image Gallery -->
        <div class="section">
            <h2 class="editable" contenteditable="false">üì∏ Market Storm Documentation Gallery</h2>
            <div style="background: linear-gradient(135deg, rgba(255,255,255,0.8) 0%, rgba(248,249,250,0.8) 100%); min-height: 200px; border: 4px dashed var(--tmd-blue); border-radius: 20px; display: flex; align-items: center; justify-content: center; margin: 20px 0; transition: all 0.3s ease; position: relative;" id="imageDropZone">
                <div style="text-align: center; color: var(--tmd-black);">
                    <p style="font-size: 1.3rem; margin-bottom: 10px;">üì∑ Upload Market Storm Photos</p>
                    <p style="color: var(--tmd-blue); font-size: 1rem;">Drag & drop images or click to browse</p>
                    <small style="color: var(--tmd-black);">Supports JPG, PNG, GIF ‚Ä¢ Auto-resize enabled</small>
                </div>
                <input type="file" id="imageInput" multiple accept="image/*" style="display: none;">
            </div>
        </div>
    </div>

    <!-- Enhanced Floating Action Menu -->
    <button class="floating-action" onclick="toggleFabMenu()" title="Actions">‚öôÔ∏è</button>
    
    <div class="fab-menu" id="fabMenu">
        <button class="fab-item" onclick="addChart()" title="Add Chart">üìä</button>
        <button class="fab-item" onclick="addTable()" title="Add Table">üìã</button>
        <button class="fab-item" onclick="addKPI()" title="Add KPI">üìà</button>
        <button class="fab-item" onclick="addText()" title="Add Text">üìù</button>
        <button class="fab-item" onclick="openModal()" title="Settings">‚öôÔ∏è</button>
    </div>

    <!-- Enhanced Modal System -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <h3 style="color: var(--tmd-blue); margin-bottom: 20px; text-align: center;">üéõÔ∏è Presentation Controls</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; margin-bottom: 20px;">
                <button class="btn" onclick="resetPresentation()">üîÑ Reset</button>
                <button class="btn" onclick="fullScreen()">üî≥ Fullscreen</button>
                <button class="btn" onclick="printPresentation()">üñ®Ô∏è Print</button>
                <button class="btn" onclick="sharePresentation()">üì§ Share</button>
            </div>
            <div style="margin: 20px 0;">
                <h4 style="color: var(--tmd-black); margin-bottom: 10px;">Quick Actions:</h4>
                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                    <button class="btn" onclick="addCustomMetric()">‚ûï Custom Metric</button>
                    <button class="btn" onclick="generateReport()">üìÑ Generate Report</button>
                    <button class="btn" onclick="scheduleUpdate()">‚è∞ Schedule Update</button>
                </div>
            </div>
            <button class="btn" onclick="closeModal()" style="width: 100%; background: var(--gradient-isuzu);">‚ùå Close</button>
        </div>
    </div>

    <script>
        // Global Variables
        let editMode = false;
        let fabMenuOpen = false;
        let presentationData = {};

        // Enhanced Theme Management with Smooth Transitions
        function changeTheme(theme) {
            const body = document.body;
            body.style.transition = 'all 0.5s ease';
            body.className = theme === 'default' ? '' : `theme-${theme}`;
            
            setTimeout(() => {
                if (window.marketStormChart) updateChartTheme(window.marketStormChart, theme);
                if (window.projectionChart) updateChartTheme(window.projectionChart, theme);
            }, 100);
            
            localStorage.setItem('tmd-pdc-theme', theme);
            setTimeout(() => {
                body.style.transition = '';
            }, 500);
        }

        function updateChartTheme(chart, theme) {
            const themeColors = {
                default: ['#1E90FF', '#FFD700', '#E74C3C', '#2ECC71', '#9B59B6', '#F39C12'],
                yellow: ['#FFD700', '#FFA500', '#FF8C00', '#FF4500', '#FFB347', '#FFDF00'],
                blue: ['#1E90FF', '#0066CC', '#003D7A', '#001F3F', '#4682B4', '#5F9EA0'],
                dark: ['#ECF0F1', '#BDC3C7', '#95A5A6', '#7F8C8D', '#34495E', '#2C3E50']
            };
            
            chart.data.datasets.forEach((dataset, index) => {
                dataset.backgroundColor = themeColors[theme][index % themeColors[theme].length];
                dataset.borderColor = themeColors[theme][index % themeColors[theme].length];
            });
            chart.update('none');
        }

        // Enhanced Edit Mode Toggle with Table Cell and Title Handling
        function toggleEdit() {
            editMode = !editMode;
            const editables = document.querySelectorAll('.editable:not(.non-editable)');
            const editBtn = document.getElementById('editBtn');
            
            editables.forEach(element => {
                element.contentEditable = editMode;
                if (editMode) {
                    element.style.border = '2px dashed var(--tmd-blue)';
                    element.style.background = 'rgba(30, 144, 255, 0.05)';
                } else {
                    element.style.border = '2px dashed transparent';
                    element.style.background = '';
                    saveElementContent(element);
                }
            });
            
            editBtn.innerHTML = editMode ? 'üíæ Save' : '‚úèÔ∏è Edit';
            editBtn.style.background = editMode ? 'var(--gradient-isuzu)' : 'var(--gradient-primary)';
            
            if (!editMode) {
                showNotification('Changes saved successfully!', 'success');
                savePresentationData();
            }
        }

        // Save individual element content
        function saveElementContent(element) {
            const id = element.getAttribute('data-id') || `elem-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
            element.setAttribute('data-id', id);
            presentationData[id] = element.innerHTML;
            localStorage.setItem('tmd-pdc-data', JSON.stringify(presentationData));
        }

        // Save all presentation data
        function savePresentationData() {
            document.querySelectorAll('.editable:not(.non-editable)').forEach(saveElementContent);
        }

        // Load saved presentation data
        function loadPresentationData() {
            const savedData = localStorage.getItem('tmd-pdc-data');
            if (savedData) {
                presentationData = JSON.parse(savedData);
                Object.entries(presentationData).forEach(([id, content]) => {
                    const element = document.querySelector(`[data-id="${id}"]`);
                    if (element) {
                        element.innerHTML = content;
                    }
                });
            }
        }

        // Enhanced Image Handling with Preview and Management
        const imageDropZone = document.getElementById('imageDropZone');
        const imageInput = document.getElementById('imageInput');

        imageDropZone.addEventListener('click', () => imageInput.click());

        imageDropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            imageDropZone.style.borderColor = 'var(--tmd-yellow)';
            imageDropZone.style.background = 'linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(30, 144, 255, 0.1) 100%)';
        });

        imageDropZone.addEventListener('dragleave', () => {
            imageDropZone.style.borderColor = 'var(--tmd-blue)';
            imageDropZone.style.background = 'linear-gradient(135deg, rgba(255,255,255,0.8) 0%, rgba(248,249,250,0.8) 100%)';
        });

        imageDropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            imageDropZone.style.borderColor = 'var(--tmd-blue)';
            imageDropZone.style.background = 'linear-gradient(135deg, rgba(255,255,255,0.8) 0%, rgba(248,249,250,0.8) 100%)';
            handleFiles(e.dataTransfer.files);
        });

        imageInput.addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });

        function handleFiles(files) {
            Array.from(files).forEach((file, index) => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        setTimeout(() => addDraggableImage(e.target.result, file.name), index * 200);
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        function addDraggableImage(src, filename) {
            const container = document.createElement('div');
            container.style.cssText = `
                display: inline-block; 
                margin: 15px; 
                text-align: center; 
                position: relative;
                transition: all 0.3s ease;
            `;
            
            const img = document.createElement('img');
            img.src = src;
            img.style.cssText = `
                max-width: 200px; 
                max-height: 200px; 
                border-radius: 15px; 
                cursor: move; 
                border: 3px solid var(--tmd-yellow);
                box-shadow: 0 8px 25px rgba(0,0,0,0.15);
                transition: all 0.3s ease;
            `;
            img.draggable = true;
            img.title = filename;
            
            const label = document.createElement('p');
            label.textContent = filename.length > 25 ? filename.substring(0, 25) + '...' : filename;
            label.style.cssText = `
                margin: 8px 0 0 0; 
                font-size: 0.8rem; 
                color: var(--tmd-blue);
                font-weight: bold;
            `;
            
            const deleteBtn = document.createElement('button');
            deleteBtn.innerHTML = '‚ùå';
            deleteBtn.style.cssText = `
                position: absolute;
                top: -10px;
                right: -10px;
                width: 25px;
                height: 25px;
                border-radius: 50%;
                border: none;
                background: var(--tmd-red);
                color: white;
                cursor: pointer;
                font-size: 12px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.2);
                transition: all 0.3s ease;
            `;
            
            deleteBtn.onclick = () => container.remove();
            deleteBtn.onmouseover = () => deleteBtn.style.transform = 'scale(1.2)';
            deleteBtn.onmouseout = () => deleteBtn.style.transform = 'scale(1)';
            
            img.onmouseover = () => {
                img.style.transform = 'scale(1.05)';
                img.style.boxShadow = '0 15px 35px rgba(0,0,0,0.25)';
            };
            img.onmouseout = () => {
                img.style.transform = 'scale(1)';
                img.style.boxShadow = '0 8px 25px rgba(0,0,0,0.15)';
            };
            
            img.addEventListener('dragstart', (e) => {
                e.dataTransfer.setData('text/plain', '');
                e.dataTransfer.effectAllowed = 'move';
                container.style.opacity = '0.7';
            });

            img.addEventListener('dragend', (e) => {
                container.style.opacity = '1';
            });

            container.appendChild(img);
            container.appendChild(label);
            container.appendChild(deleteBtn);
            imageDropZone.appendChild(container);
            
            container.style.transform = 'scale(0)';
            setTimeout(() => {
                container.style.transform = 'scale(1)';
            }, 100);
        }

        // Enhanced Chart Initialization
        function initializeCharts() {
            const ctx1 = document.getElementById('marketStormChart').getContext('2d');
            window.marketStormChart = new Chart(ctx1, {
                type: 'bar',
                data: {
                    labels: ['Stockists\nVisited', 'PGMs\nEngaged', 'Sample\nKits', 'Qualified\nLeads', 'Orders\nReceived', 'Revenue\n(K KES)'],
                    datasets: [{
                        label: 'Market Storm Performance',
                        data: [47, 32, 156, 89, 23, 650],
                        backgroundColor: [
                            'rgba(30, 144, 255, 0.8)',
                            'rgba(255, 215, 0, 0.8)',
                            'rgba(231, 76, 60, 0.8)',
                            'rgba(46, 204, 113, 0.8)',
                            'rgba(155, 89, 182, 0.8)',
                            'rgba(243, 156, 18, 0.8)'
                        ],
                        borderColor: [
                            'rgb(30, 144, 255)',
                            'rgb(255, 215, 0)',
                            'rgb(231, 76, 60)',
                            'rgb(46, 204, 113)',
                            'rgb(155, 89, 182)',
                            'rgb(243, 156, 18)'
                        ],
                        borderWidth: 3,
                        borderRadius: 8,
                        borderSkipped: false,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Market Storm Success Metrics - July 2025',
                            font: { size: 16, weight: 'bold' },
                            color: '#2C3E50'
                        },
                        legend: { display: false },
                        datalabels: {
                            anchor: 'end',
                            align: 'top',
                            color: '#2C3E50',
                            font: { weight: 'bold', size: 12 },
                            formatter: function(value, context) {
                                return context.dataIndex === 5 ? 'KES ' + value + 'K' : value;
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Performance Values', font: { weight: 'bold' } },
                            grid: { color: 'rgba(0,0,0,0.1)' }
                        },
                        x: {
                            title: { display: true, text: 'Key Performance Indicators', font: { weight: 'bold' } },
                            grid: { display: false }
                        }
                    },
                    animation: { duration: 2000, easing: 'easeInOutQuart' }
                }
            });

            const ctx2 = document.getElementById('projectionChart').getContext('2d');
            window.projectionChart = new Chart(ctx2, {
                type: 'line',
                data: {
                    labels: ['Q3 2025', 'Q4 2025', 'Q1 2026', 'Q2 2026', 'Q3 2026', 'Q4 2026'],
                    datasets: [
                        {
                            label: 'Sales Volume (Millions KES)',
                            data: [12, 18, 25, 35, 42, 50],
                            borderColor: 'rgb(30, 144, 255)',
                            backgroundColor: 'rgba(30, 144, 255, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 6,
                            pointBackgroundColor: 'rgb(30, 144, 255)',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2
                        },
                        {
                            label: 'Active Stockists',
                            data: [88, 120, 155, 180, 200, 220],
                            borderColor: 'rgb(255, 215, 0)',
                            backgroundColor: 'rgba(255, 215, 0, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 6,
                            pointBackgroundColor: 'rgb(255, 215, 0)',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2
                        },
                        {
                            label: 'Market Share (%)',
                            data: [15, 20, 25, 28, 32, 35],
                            borderColor: 'rgb(231, 76, 60)',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 6,
                            pointBackgroundColor: 'rgb(231, 76, 60)',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2
                        }
                    ]
                },
                options: {                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'TMD PDC Growth Trajectory - 18 Month Projection',
                            font: { size: 16, weight: 'bold' },
                            color: '#2C3E50'
                        },
                        legend: {
                            position: 'top',
                            labels: { usePointStyle: true, padding: 20 }
                        },
                        tooltip: {
                            enabled: true,
                            backgroundColor: 'rgba(44, 62, 80, 0.9)',
                            titleFont: { size: 14, weight: 'bold' },
                            bodyFont: { size: 12 },
                            padding: 12,
                            cornerRadius: 8,
                            boxPadding: 6,
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.dataset.label.includes('KES') 
                                            ? `KES ${context.parsed.y}M` 
                                            : context.dataset.label.includes('Market Share') 
                                            ? `${context.parsed.y}%` 
                                            : context.parsed.y;
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Growth Metrics', font: { weight: 'bold' } },
                            grid: { color: 'rgba(0,0,0,0.1)' }
                        },
                        x: {
                            title: { display: true, text: 'Timeline (Quarters)', font: { weight: 'bold' } },
                            grid: { color: 'rgba(0,0,0,0.1)' }
                        }
                    },
                    animation: { duration: 2500, easing: 'easeInOutQuint' },
                    hover: {
                        animationDuration: 400,
                        mode: 'nearest',
                        intersect: true
                    },
                    elements: {
                        line: {
                            borderWidth: 3,
                            borderCapStyle: 'round',
                            borderJoinStyle: 'round'
                        },
                        point: {
                            hoverRadius: 8,
                            hoverBorderWidth: 3,
                            hitRadius: 10
                        }
                    }
                }
            });
        }

        // Enhanced Floating Action Menu
        function toggleFabMenu() {
            fabMenuOpen = !fabMenuOpen;
            const fabMenu = document.getElementById('fabMenu');
            fabMenu.classList.toggle('show');
            const fabButton = document.querySelector('.floating-action');
            fabButton.style.transform = fabMenuOpen ? 'scale(1.2) rotate(45deg)' : 'scale(1) rotate(0deg)';
            fabButton.style.background = fabMenuOpen ? 'var(--gradient-isuzu)' : 'var(--gradient-primary)';
            fabMenu.style.animation = fabMenuOpen ? 'fabExpand 0.5s ease forwards' : 'fabCollapse 0.5s ease forwards';
        }

        // FAB Menu Animations
        const fabKeyframes = `
            @keyframes fabExpand {
                0% { transform: scale(0); opacity: 0; }
                100% { transform: scale(1); opacity: 1; }
            }
            @keyframes fabCollapse {
                0% { transform: scale(1); opacity: 1; }
                100% { transform: scale(0); opacity: 0; }
            }
        `;
        const styleSheet = document.createElement('style');
        styleSheet.innerText = fabKeyframes;
        document.head.appendChild(styleSheet);

        // Add New Chart with Interactive Features
        function addChart() {
            const section = document.createElement('div');
            section.className = 'section';
            section.innerHTML = `
                <h2 class="editable" contenteditable="${editMode}">üìä New Interactive Chart</h2>
                <div class="chart-container">
                    <canvas></canvas>
                    <div class="chart-controls" style="display: flex; gap: 10px; margin-top: 10px; justify-content: center;">
                        <button class="btn" onclick="updateChartData(this, 'random')">üé≤ Randomize</button>
                        <button class="btn" onclick="updateChartData(this, 'reset')">üîÑ Reset</button>
                    </div>
                </div>
            `;
            document.querySelector('.container').appendChild(section);
            
            const canvas = section.querySelector('canvas');
            const newChart = new Chart(canvas, {
                type: 'bar',
                data: {
                    labels: ['Metric 1', 'Metric 2', 'Metric 3', 'Metric 4'],
                    datasets: [{
                        label: 'Dynamic Dataset',
                        data: [10, 20, 30, 40],
                        backgroundColor: ['rgba(30, 144, 255, 0.8)', 'rgba(255, 215, 0, 0.8)', 'rgba(231, 76, 60, 0.8)', 'rgba(46, 204, 113, 0.8)'],
                        borderColor: ['rgb(30, 144, 255)', 'rgb(255, 215, 0)', 'rgb(231, 76, 60)', 'rgb(46, 204, 113)'],
                        borderWidth: 3,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: { display: true, text: 'Dynamic Performance Chart', font: { size: 16, weight: 'bold' }, color: '#2C3E50' },
                        legend: { display: false },
                        tooltip: { enabled: true, mode: 'index', intersect: false }
                    },
                    scales: {
                        y: { beginAtZero: true, title: { display: true, text: 'Values', font: { weight: 'bold' } } },
                        x: { title: { display: true, text: 'Categories', font: { weight: 'bold' } } }
                    },
                    animation: { duration: 1500, easing: 'easeOutBounce' }
                }
            });
            
            section.querySelector('h2').addEventListener('input', () => saveElementContent(section.querySelector('h2')));
            showNotification('Interactive chart added!', 'success');
            savePresentationData();
        }

        // Update Chart Data Dynamically
        function updateChartData(button, action) {
            const chart = button.closest('.chart-container').querySelector('canvas').__chartjs__;
            if (action === 'random') {
                chart.data.datasets[0].data = chart.data.datasets[0].data.map(() => Math.floor(Math.random() * 100));
                chart.update();
                showNotification('Chart data randomized!', 'success');
            } else if (action === 'reset') {
                chart.data.datasets[0].data = [10, 20, 30, 40];
                chart.update();
                showNotification('Chart data reset!', 'success');
            }
            savePresentationData();
        }

        // Add New Table with Advanced Features
        function addTable() {
            const section = document.createElement('div');
            section.className = 'section';
            section.innerHTML = `
                <h2 class="editable" contenteditable="${editMode}">üìã Dynamic Data Table</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="editable" contenteditable="${editMode}">Metric</th>
                                <th class="editable" contenteditable="${editMode}">Q1</th>
                                <th class="editable" contenteditable="${editMode}">Q2</th>
                                <th class="editable" contenteditable="${editMode}">Q3</th>
                                <th class="non-editable">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="editable" contenteditable="${editMode}">Revenue (KES)</td>
                                <td class="editable" contenteditable="${editMode}">10M</td>
                                <td class="editable" contenteditable="${editMode}">12M</td>
                                <td class="editable" contenteditable="${editMode}">15M</td>
                                <td class="non-editable"><button class="btn" onclick="addTableRow(this)">‚ûï</button></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;
            document.querySelector('.container').appendChild(section);
            
            section.querySelectorAll('.editable').forEach(el => {
                el.addEventListener('input', () => saveElementContent(el));
            });
            showNotification('Dynamic table added!', 'success');
            savePresentationData();
        }

        // Add Table Row Dynamically
        function addTableRow(button) {
            const table = button.closest('table');
            const tbody = table.querySelector('tbody');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td class="editable" contenteditable="${editMode}">New Metric</td>
                <td class="editable" contenteditable="${editMode}">0</td>
                <td class="editable" contenteditable="${editMode}">0</td>
                <td class="editable" contenteditable="${editMode}">0</td>
                <td class="non-editable"><button class="btn" onclick="addTableRow(this)">‚ûï</button> <button class="btn" onclick="deleteTableRow(this)">üóëÔ∏è</button></td>
            `;
            tbody.appendChild(row);
            row.querySelectorAll('.editable').forEach(el => {
                el.addEventListener('input', () => saveElementContent(el));
            });
            showNotification('Table row added!', 'success');
            savePresentationData();
        }

        // Delete Table Row
        function deleteTableRow(button) {
            button.closest('tr').remove();
            showNotification('Table row deleted!', 'success');
            savePresentationData();
        }

        // Add New KPI with Animation
        function addKPI() {
            const section = document.createElement('div');
            section.className = 'section';
            section.innerHTML = `
                <h2 class="editable" contenteditable="${editMode}">üìà Key Performance Indicator</h2>
                <div class="stats-grid">
                    <div class="stat-card" style="animation: cardPop 0.5s ease;">
                        <div class="stat-number editable" contenteditable="${editMode}">0</div>
                        <div class="stat-label editable" contenteditable="${editMode}">New Metric</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 0%;" data-percent="0%"></div>
                        </div>
                        <small class="editable" contenteditable="${editMode}">Enter details here</small>
                    </div>
                </div>
            `;
            document.querySelector('.container').appendChild(section);
            
            section.querySelectorAll('.editable').forEach(el => {
                el.addEventListener('input', () => saveElementContent(el));
            });
            
            // Progress Bar Animation
            const progressFill = section.querySelector('.progress-fill');
            setTimeout(() => {
                progressFill.style.width = '50%';
                progressFill.setAttribute('data-percent', '50%');
            }, 500);
            
            showNotification('New KPI added with flair!', 'success');
            savePresentationData();
        }

        // Add New Text Section with Rich Editor
        function addText() {
            const section = document.createElement('div');
            section.className = 'section';
            section.innerHTML = `
                <h2 class="editable" contenteditable="${editMode}">üìù Insightful Narrative</h2>
                <div class="rich-text-editor" style="min-height: 150px; padding: 15px; border-radius: 10px; background: rgba(255,255,255,0.95); border: 2px solid var(--tmd-blue);">
                    <p class="editable" contenteditable="${editMode}" style="color: var(--tmd-black); line-height: 1.8; font-size: 1.1rem;">
                        Share your insights, strategies, or notes here...
                    </p>
                </div>
            `;
            document.querySelector('.container').appendChild(section);
            
            section.querySelectorAll('.editable').forEach(el => {
                el.addEventListener('input', () => saveElementContent(el));
            });
            showNotification('Rich text section added!', 'success');
            savePresentationData();
        }

        // Modal Controls with Enhanced Animations
        function openModal() {
            const modal = document.getElementById('modal');
            modal.style.display = 'flex';
            modal.querySelector('.modal-content').style.animation = 'modalPop 0.4s ease forwards';
        }

        function closeModal() {
            const modal = document.getElementById('modal');
            modal.querySelector('.modal-content').style.animation = 'modalFade 0.4s ease forwards';
            setTimeout(() => {
                modal.style.display = 'none';
            }, 400);
        }

        // Modal Animation Keyframes
        const modalKeyframes = `
            @keyframes modalPop {
                0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
                100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            }
            @keyframes modalFade {
                0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
                100% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
            }
            @keyframes cardPop {
                0% { transform: scale(0.8); opacity: 0; }
                100% { transform: scale(1); opacity: 1; }
            }
        `;
        const modalStyleSheet = document.createElement('style');
        modalStyleSheet.innerText = modalKeyframes;
        document.head.appendChild(modalStyleSheet);

        // Enhanced Notification System
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                border-radius: 10px;
                color: white;
                font-weight: bold;
                z-index: 3000;
                transition: all 0.5s ease;
                opacity: 0;
                transform: translateX(100px);
                background: ${type === 'success' ? 'var(--gradient-primary)' : 'var(--gradient-isuzu)'};
                box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100px)';
                setTimeout(() => notification.remove(), 500);
            }, 3000);
        }

        // Export to PDF with Enhanced Quality
        async function exportToPDF() {
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4',
                    compress: true
                });
                
                const container = document.querySelector('.container');
                const sections = document.querySelectorAll('.section');
                let yOffset = 10;
                const pageHeight = doc.internal.pageSize.getHeight();
                const margin = 10;

                for (const section of sections) {
                    const canvas = await html2canvas(section, {
                        scale: 3,
                        useCORS: true,
                        logging: false,
                        backgroundColor: '#FFFFFF'
                    });
                    
                    const imgData = canvas.toDataURL('image/jpeg', 0.95);
                    const imgProps = doc.getImageProperties(imgData);
                    const pdfWidth = doc.internal.pageSize.getWidth() - 2 * margin;
                    const imgHeight = (imgProps.height * pdfWidth) / imgProps.width;
                    
                    if (yOffset + imgHeight > pageHeight - margin) {
                        doc.addPage();
                        yOffset = 10;
                    }
                    
                    doc.addImage(imgData, 'JPEG', margin, yOffset, pdfWidth, imgHeight);
                    yOffset += imgHeight + 10;
                }
                
                doc.save('TMD_PDC_Presentation.pdf');
                showNotification('PDF exported with enhanced quality!', 'success');
            } catch (error) {
                console.error('PDF Export Error:', error);
                showNotification('Failed to export PDF', 'error');
            }
        }

        // Save Presentation with Versioning
        function savePresentation() {
            savePresentationData();
            showNotification('Presentation saved with version control!', 'success');
        }

        // Reset Presentation with Confirmation
        function resetPresentation() {
            if (confirm('Are you sure you want to reset the presentation? All changes will be lost.')) {
                localStorage.removeItem('tmd-pdc-data');
                presentationData = {};
                location.reload();
                showNotification('Presentation reset to default!', 'success');
            }
        }

        // Fullscreen Mode with Enhanced Feedback
        function fullScreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
                showNotification('Immersive fullscreen mode activated!', 'success');
            } else {
                document.exitFullscreen();
                showNotification('Exited fullscreen mode!', 'success');
            }
        }

        // Print Presentation with Optimized Layout
        function printPresentation() {
            window.print();
            showNotification('Printing optimized presentation...', 'success');
        }

        // Share Presentation with Social Integration
        function sharePresentation() {
            const shareData = {
                title: 'TMD PDC Project Presentation',
                text: 'Explore the TMD PDC Project: Revolutionizing Kenya\'s automotive distribution network!',
                url: window.location.href
            };
            if (navigator.share) {
                navigator.share(shareData)
                    .then(() => showNotification('Presentation shared successfully!', 'success'))
                    .catch(() => showNotification('Failed to share presentation', 'error'));
            } else {
                navigator.clipboard.writeText(window.location.href)
                    .then(() => showNotification('Presentation link copied to clipboard!', 'success'))
                    .catch(() => showNotification('Failed to copy link', 'error'));
            }
        }

        // Add Custom Metric with Visual Feedback
        function addCustomMetric() {
            addKPI();
            closeModal();
            showNotification('Custom metric added with style!', 'success');
        }

        // Generate Report with Analytics
        function generateReport() {
            exportToPDF();
            closeModal();
            showNotification('Comprehensive report generated!', 'success');
        }

        // Schedule Update with Animation
        function scheduleUpdate() {
            showNotification('Update scheduled with precision!', 'success');
            closeModal();
            const fabButton = document.querySelector('.floating-action');
            fabButton.style.animation = 'pulse 0.5s ease 3';
            setTimeout(() => fabButton.style.animation = '', 1500);
        }

        // Initialize on Load with Enhanced Features
        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('tmd-pdc-theme') || 'default';
            changeTheme(savedTheme);
            loadPresentationData();
            initializeCharts();
            
            // Auto-save on content change
            document.querySelectorAll('.editable').forEach(element => {
                element.addEventListener('input', () => {
                    if (editMode) {
                        saveElementContent(element);
                    }
                });
            });
            
            // Keyboard Shortcuts with Enhanced Feedback
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.key === 's') {
                    e.preventDefault();
                    savePresentation();
                    showNotification('Quick save activated!', 'success');
                }
                if (e.key === 'Escape') {
                    closeModal();
                    if (fabMenuOpen) toggleFabMenu();
                    showNotification('Quick exit triggered!', 'success');
                }
                if (e.ctrlKey && e.key === 'p') {
                    e.preventDefault();
                    printPresentation();
                }
            });
            
            // Enhanced Table Cell Interactions
            document.querySelectorAll('td.editable:not(.non-editable), th.editable:not(.non-editable), h2.editable').forEach(cell => {
                cell.addEventListener('focus', () => {
                    cell.style.background = 'rgba(255, 215, 0, 0.1)';
                    cell.style.border = '2px solid var(--tmd-yellow)';
                    cell.style.transform = 'scale(1.02)';
                });
                cell.addEventListener('blur', () => {
                    cell.style.background = '';
                    cell.style.border = '';
                    cell.style.transform = 'scale(1)';
                    if (editMode) saveElementContent(cell);
                });
            });
            
            // Drag and Drop for Sections with Smooth Transitions
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                section.draggable = true;
                section.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', '');
                    section.style.opacity = '0.7';
                    section.style.transform = 'scale(0.98)';
                });
                section.addEventListener('dragend', () => {
                    section.style.opacity = '1';
                    section.style.transform = 'scale(1)';
                });
                section.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    section.style.border = '3px dashed var(--tmd-blue)';
                });
                section.addEventListener('dragleave', () => {
                    section.style.border = 'none';
                });
                section.addEventListener('drop', (e) => {
                    e.preventDefault();
                    section.style.border = 'none';
                    const draggedSection = document.querySelector('.section[style*="opacity: 0.7"]');
                    if (draggedSection && draggedSection !== section) {
                        const container = document.querySelector('.container');
                        container.insertBefore(draggedSection, section);
                        savePresentationData();
                        showNotification('Section reordered with style!', 'success');
                    }
                });
            });

            // Voice Command Integration
            if ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {
                const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
                recognition.lang = 'en-US';
                recognition.interimResults = false;
                recognition.maxAlternatives = 1;
                
                recognition.onresult = (event) => {
                    const command = event.results[0][0].transcript.toLowerCase();
                    if (command.includes('add chart')) addChart();
                    else if (command.includes('add table')) addTable();
                    else if (command.includes('add kpi')) addKPI();
                    else if (command.includes('add text')) addText();
                    else if (command.includes('save')) savePresentation();
                    else if (command.includes('export')) exportToPDF();
                    else if (command.includes('fullscreen')) fullScreen();
                    else showNotification('Unrecognized voice command', 'error');
                };
                
                recognition.onerror = () => showNotification('Voice recognition failed', 'error');
                
                document.querySelector('.floating-action').addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    recognition.start();
                    showNotification('Voice command mode activated!', 'success');
                });
            }
        });
    </script>
</body>
</html>
